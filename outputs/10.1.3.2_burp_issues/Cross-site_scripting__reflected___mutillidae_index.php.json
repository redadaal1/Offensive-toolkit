{
  "name": "Cross-site scripting (reflected)",
  "type": "vulnerability",
  "severity": "Medium",
  "confidence": "Certain",
  "host": "",
  "path": "/mutillidae/index.php",
  "url": "/mutillidae/index.php",
  "evidence": [
    {
      "type": "FirstOrderEvidence",
      "detail": {
        "payload": {
          "bytes": "ADc0NTQxJzthbGVydCgxKS8vNzM0",
          "flags": 6
        },
        "band_flags": [
          "in_band"
        ]
      },
      "request_response": {
        "url": "http://10.1.3.2/mutillidae/index.php?page=home.php",
        "request": [
          {
            "type": "DataSegment",
            "data": "R0VUIC9tdXRpbGxpZGFlL2luZGV4LnBocD9wYWdlPWhvbWUucGhwIEhUVFAvMS4xDQpIb3N0OiAxMC4xLjMuMg0KQ2FjaGUtQ29udHJvbDogbWF4LWFnZT0wDQpTZWMtQ0gtVUE6ICJHb29nbGUgQ2hyb21lIjt2PSIxMzgiLCAiTm90PUE/QnJhbmQiO3Y9IjgiLCAiQ2hyb21pdW0iO3Y9IjEzOCINClNlYy1DSC1VQS1Nb2JpbGU6ID8wDQpTZWMtQ0gtVUEtUGxhdGZvcm06ICJMaW51eCINCkFjY2VwdC1MYW5ndWFnZTogZW4tVVM7cT0wLjksZW47cT0wLjgNClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzOC4wLjAuMCBTYWZhcmkvNTM3LjM2DQpBY2NlcHQ6IHRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuNw0KU2VjLUZldGNoLVNpdGU6IG5vbmUNClNlYy1GZXRjaC1Nb2RlOiBuYXZpZ2F0ZQ0KU2VjLUZldGNoLVVzZXI6ID8xDQpTZWMtRmV0Y2gtRGVzdDogZG9jdW1lbnQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZSwgYnINCkNvbm5lY3Rpb246IGNsb3NlDQpDb29raWU6IHNob3doaW50cz0x",
            "length": 687
          },
          {
            "type": "HighlightSegment",
            "data": "JTAwNzQ1NDEnJTNiYWxlcnQoMSklMmYlMmY3MzQ=",
            "length": 29
          },
          {
            "type": "DataSegment",
            "data": "OyBQSFBTRVNTSUQ9NTgyN2NmZDllZThmYWJmZGE4NTc2Mjc5OWVkMjU0OTUNClVwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHM6IDENClJlZmVyZXI6IGh0dHA6Ly9iMzIwYmE5MS03YjFiLTQ3ZTMtYjkzNS01MDRhN2UxOGE3ZWMuY29tLw0KDQo=",
            "length": 137
          }
        ],
        "response": [
          {
            "type": "DataSegment",
            "data": "SFRUUC8xLjEgMjAwIE9LDQpEYXRlOiBUaHUsIDA0IFNlcCAyMDI1IDEzOjQ0OjMzIEdNVA0KU2VydmVyOiBBcGFjaGUvMi4yLjggKFVidW50dSkgREFWLzINClgtUG93ZXJlZC1CeTogUEhQLzUuMi40LTJ1YnVudHU1LjEwDQpFeHBpcmVzOiBUaHUsIDE5IE5vdiAxOTgxIDA4OjUyOjAwIEdNVA0KTG9nZ2VkLUluLVVzZXI6IA0KQ2FjaGUtQ29udHJvbDogcHVibGljDQpQcmFnbWE6IHB1YmxpYw0KTGFzdC1Nb2RpZmllZDogVGh1LCAwNCBTZXAgMjAyNSAxMzo0NDozNCBHTVQNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbA0KQ29udGVudC1MZW5ndGg6IDI2MTMyDQoNCg0KCQkJPCEtLSBJIHRoaW5rIHRoZSBkYXRhYmFzZSBwYXNzd29yZCBpcyBzZXQgdG8gYmxhbmsgb3IgcGVyaGFwcyBzYW11cmFpLg0KCQkJSXQgZGVwZW5kcyBvbiB3aGV0aGVyIHlvdSBpbnN0YWxsZWQgdGhpcyB3ZWIgYXBwIGZyb20gaXJvbmdlZWtzIHNpdGUgb3INCgkJCWFyZSB1c2luZyBpdCBpbnNpZGUgS2V2aW4gSm9obnNvbnMgU2FtdXJhaSB3",
            "length": 540
          },
          {
            "type": "SnipSegment",
            "length": 1868
          },
          {
            "type": "DataSegment",
            "data": "PHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KCQl2YXIgb25Mb2FkT2ZCb2R5ID0gZnVuY3Rpb24odGhlQm9keSl7DQoJCQl2YXIgbF9zZWN1cml0eUxldmVsID0gJzAnOw0KCQkJCQkJdmFyIGxfaGludHNTdGF0dXMgPSAnRW5hYmxlZCAoMQA=",
            "length": 143
          },
          {
            "type": "HighlightSegment",
            "data": "NzQ1NDEnO2FsZXJ0KDEpLy83MzQ=",
            "length": 20
          },
          {
            "type": "DataSegment",
            "data": "IC0gNWNyMXB0IEsxZGQxZSknOw0KCQkJDQoJCQlzd2l0Y2gobF9zZWN1cml0eUxldmVsKXsNCgkJCQljYXNlICIwIjogdmFyIGxfc2VjdXJpdHlMZXZlbERlc2NyaXB0aW9uID0gJ0hvc2VkJzsgYnJlYWs7DQoJCQkJY2FzZSAiMSI6IHZhciBsX3NlY3VyaXR5TGV2ZWxEZXNjcmlwdGlvbiA9ICdBcnJvZ2VudCc7IGJyZWFrOw0KCQkJCWNhc2UgIjIiOiB2",
            "length": 201
          },
          {
            "type": "SnipSegment",
            "length": 23700
          }
        ],
        "was_redirect_followed": false,
        "request_time": "238"
      }
    }
  ],
  "description": "The value of the <b>showhints</b> cookie is copied into a JavaScript string which is encapsulated in single quotation marks. The payload <b>[0x00]74541';alert(1)//734</b> was submitted in the showhints cookie. This input was echoed as <b>74541';alert(1)//734</b> in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>The application attempts to block certain characters that are often used in XSS attacks but this can be circumvented by submitting a NULL byte anywhere before the characters that are being blocked. <br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain \"cookie-forcing\" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.",
  "remediation": "Echoing user-controllable data within a script context is inherently dangerous and can make XSS attacks difficult to prevent. If at all possible, the application should avoid echoing user data within this context. NULL byte bypasses typically arise when the application is being defended by a web application firewall (WAF) that is written in native code, where strings are terminated by a NULL byte. You should fix the actual vulnerability within the application code, and if appropriate ask your WAF vendor to provide a fix for the NULL byte bypass. ",
  "references": []
}